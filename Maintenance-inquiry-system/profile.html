<!DOCTYPE html>
<html lang="zh-Hant">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>用戶資料 - 維修查詢系統</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="assets/css/styles.css">
</head>

<body>
    <div class="container mt-5">
        <h2 class="text-center mb-4">用戶資料</h2>
        <form id="profile-form" class="p-4 border rounded bg-light">
            <h4 class="mb-3">個人資訊</h4>
            <div class="mb-3">
                <label for="username" class="form-label">帳號</label>
                <input type="text" id="username" name="username" class="form-control" disabled>
            </div>
            <div class="mb-3">
                <label for="full_name" class="form-label">姓名</label>
                <input type="text" id="full_name" name="full_name" class="form-control" required>
            </div>
            <div class="mb-3">
                <label for="email" class="form-label">電子郵件</label>
                <input type="email" id="email" name="email" class="form-control" required>
            </div>
            <div class="mb-3">
                <label for="contact_number" class="form-label">聯絡電話</label>
                <input type="tel" id="contact_number" name="contact_number" class="form-control" required>
            </div>

            <h4 class="mt-4 mb-3">車輛資訊</h4>
            <div class="mb-3">
                <label for="license_plate" class="form-label">車牌號碼</label>
                <input type="text" id="license_plate" name="license_plate" class="form-control" required>
            </div>
            <div class="mb-3">
                <label for="brand" class="form-label">品牌</label>
                <input type="text" id="brand" name="brand" class="form-control">
            </div>
            <button type="submit" class="btn btn-primary w-100">保存更改</button>
        </form>
    </div>

    <script src="assets/js/common.js"></script>
    <script>
        function loadProfile() {
            ajaxRequest('/api/user/getProfile.php', 'GET', null, function (profile) {
                document.getElementById('full_name').value = profile.full_name;
                document.getElementById('contact_number').value = profile.contact_number;
                document.getElementById('license_plate').value = profile.license_plate;
                document.getElementById('brand').value = profile.brand;
            });
        }

        document.getElementById('profile-form').addEventListener('submit', function (e) {
            e.preventDefault();
            const data = {
                full_name: document.getElementById('full_name').value,
                contact_number: document.getElementById('contact_number').value,
                license_plate: document.getElementById('license_plate').value,
                brand: document.getElementById('brand').value
            };
            ajaxRequest('/api/user/updateProfile.php', 'POST', data, function (response) {
                alert(response.success ? "更新成功" : "更新失敗：" + response.message);
            });
        });

        document.addEventListener('DOMContentLoaded', loadProfile);
    </script>
</body>

</html>